<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relationship Assessment | Happy Ever After Couples</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2D5F7E;
            --primary-light: #4A8FB3;
            --secondary: #D4A574;
            --accent: #E8927C;
            --success: #7BA888;
            --background: #FAF8F5;
            --surface: #FFFFFF;
            --text-primary: #2C3E50;
            --text-secondary: #6B7280;
            --border: #E5DDD5;
            --shadow: rgba(45, 95, 126, 0.08);
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: linear-gradient(135deg, var(--background) 0%, #F5F1EC 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Decorative background elements */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            right: -20%;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(212, 165, 116, 0.08) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            bottom: -30%;
            left: -10%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(74, 143, 179, 0.06) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 60px;
            animation: fadeInDown 0.8s ease-out;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .tagline {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 400;
        }

        /* Welcome Card */
        .welcome-card {
            background: var(--surface);
            border-radius: 24px;
            padding: 50px 40px;
            box-shadow: 0 20px 60px var(--shadow);
            margin-bottom: 40px;
            border: 1px solid var(--border);
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }

        .welcome-card h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .welcome-card p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 25px;
        }

        .info-list {
            list-style: none;
            margin: 30px 0;
        }

        .info-list li {
            padding: 15px 0;
            padding-left: 40px;
            position: relative;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .info-list li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: 600;
            font-size: 1.3rem;
        }

        /* Form Section */
        .form-section {
            background: var(--surface);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px var(--shadow);
            border: 1px solid var(--border);
            animation: fadeInUp 0.8s ease-out 0.4s both;
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .section-header {
            border-bottom: 2px solid var(--border);
            padding-bottom: 25px;
            margin-bottom: 35px;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .section-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--background);
            border-radius: 12px;
            height: 8px;
            margin-bottom: 35px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            border-radius: 12px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 10px;
            font-weight: 500;
        }

        /* Question Card */
        .question-card {
            margin-bottom: 35px;
            padding: 30px;
            background: linear-gradient(135deg, rgba(255,255,255,0.6) 0%, rgba(250,248,245,0.8) 100%);
            border-radius: 16px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(45, 95, 126, 0.1);
        }

        .question-number {
            font-size: 0.85rem;
            color: var(--secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }

        .question-text {
            font-size: 1.15rem;
            color: var(--text-primary);
            margin-bottom: 25px;
            font-weight: 500;
            line-height: 1.5;
        }

        /* Radio Options */
        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .option-label:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(45, 95, 126, 0.1);
        }

        .option-label input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .option-label input[type="radio"]:checked + .option-text {
            color: var(--primary);
            font-weight: 600;
        }

        .option-label input[type="radio"]:checked ~ .checkmark {
            background: var(--primary);
            border-color: var(--primary);
        }

        .option-label input[type="radio"]:checked ~ .checkmark::after {
            display: block;
        }

        .checkmark {
            width: 22px;
            height: 22px;
            border: 2px solid var(--border);
            border-radius: 50%;
            margin-right: 12px;
            transition: all 0.3s ease;
            flex-shrink: 0;
            position: relative;
        }

        .checkmark::after {
            content: '';
            position: absolute;
            display: none;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
        }

        .option-text {
            font-size: 0.95rem;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        /* Navigation Buttons */
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            gap: 15px;
        }

        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'DM Sans', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            flex: 1;
            justify-content: center;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(45, 95, 126, 0.25);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Start Form */
        .start-form {
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .form-group input {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'DM Sans', sans-serif;
            transition: all 0.3s ease;
            background: var(--surface);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(45, 95, 126, 0.1);
        }

        /* Completion Screen */
        .completion-screen {
            text-align: center;
            padding: 60px 40px;
        }

        .completion-icon {
            width: 100px;
            height: 100px;
            margin: 0 auto 30px;
            background: linear-gradient(135deg, var(--success) 0%, #6B9B7A 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
            animation: scaleIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes scaleIn {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }

        .completion-screen h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .completion-screen p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 30px;
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Auto-save indicator */
        .auto-save {
            text-align: center;
            margin-top: 20px;
            color: var(--success);
            font-size: 0.9rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .auto-save.show {
            opacity: 1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }

            .welcome-card {
                padding: 35px 25px;
            }

            .form-section {
                padding: 30px 20px;
            }

            .logo {
                font-size: 2rem;
            }

            .welcome-card h1 {
                font-size: 1.8rem;
            }

            .section-title {
                font-size: 1.5rem;
            }

            .options {
                grid-template-columns: 1fr;
            }

            .navigation {
                flex-direction: column;
            }

            .btn-secondary {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">HEA Couples</div>
            <div class="tagline">Relationship Assessment Tool</div>
        </header>

        <!-- Welcome Screen -->
        <div class="welcome-card" id="welcomeScreen">
            <h1>Understanding Your Relationship</h1>
            <p>This questionnaire is designed to help you set goals for your relationship and assist in long-term decision-making. Your responses are confidential and will help guide meaningful conversations with your coach.</p>
            
            <ul class="info-list">
                <li>Takes approximately 15-20 minutes to complete</li>
                <li>75 questions across 9 key relationship areas</li>
                <li>Individual responses kept confidential</li>
                <li>Progress is automatically saved</li>
                <li>You can pause and resume at any time</li>
            </ul>

            <div class="start-form">
                <div class="form-group">
                    <label for="userName">Your Name</label>
                    <input type="text" id="userName" placeholder="Enter your name" required>
                </div>
                <div class="form-group">
                    <label for="partnerName">Partner's Name</label>
                    <input type="text" id="partnerName" placeholder="Enter your partner's name" required>
                </div>
                <div class="form-group">
                    <label for="assessmentDate">Today's Date</label>
                    <input type="date" id="assessmentDate" required>
                </div>
                
                <button class="btn btn-primary" onclick="startAssessment()" style="width: 100%; margin-top: 10px;">
                    Begin Assessment
                    <span>→</span>
                </button>
            </div>
        </div>

        <!-- Assessment Form -->
        <div class="form-section" id="assessmentForm">
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">Section 1 of 9 - Requirements</div>
            
            <div class="section-header">
                <h2 class="section-title" id="sectionTitle">Requirements</h2>
                <p class="section-description" id="sectionDescription">These questions explore the fundamental building blocks of your relationship.</p>
            </div>

            <div id="questionsContainer"></div>

            <div class="navigation">
                <button class="btn btn-secondary" onclick="previousSection()" id="prevBtn">
                    <span>←</span>
                    Previous
                </button>
                <button class="btn btn-primary" onclick="nextSection()" id="nextBtn">
                    Next Section
                    <span>→</span>
                </button>
            </div>

            <div class="auto-save" id="autoSave">✓ Progress saved</div>
        </div>
    </div>

    <script>
        // Assessment Data Structure
        const assessmentData = {
            sections: [
                {
                    id: 1,
                    name: "Requirements",
                    description: "These questions explore the fundamental building blocks of your relationship.",
                    questions: [
                        "My requirements are met",
                        "My Vision is supported",
                        "My purpose and mission are supported",
                        "I'm willing to live the rest of my life with everything exactly as it is in this relationship",
                        "I am not settling for less than I really want by choosing this relationship",
                        "We are in alignment about money",
                        "We are in alignment about future plans",
                        "We are in alignment about children and family",
                        "This relationship is addiction-free",
                        "I trust my partner to be sexually faithful",
                        "I trust my partner with my/our money",
                        "I trust my partner to be honest with me about everything",
                        "I trust my partner to keep agreements in this relationship",
                        "I can see myself growing old and happy in this relationship",
                        "I feel physically safe in this relationship"
                    ]
                },
                {
                    id: 2,
                    name: "Lifestyle",
                    description: "Questions about your daily habits and shared activities.",
                    questions: [
                        "We are in alignment about our lifestyle",
                        "We are well-matched in our food preferences and eating habits",
                        "We are well-matched in our health habits and practices",
                        "We are well-matched in our grooming and hygiene habits and practices",
                        "We are well-matched in our hobbies, physical and leisure activities",
                        "We are well-matched in our level of desire for travel and adventure",
                        "We are well-matched in our preferences to stay home and have quiet times",
                        "We travel well together",
                        "I am supported to pursue my own interests/activities in this relationship"
                    ]
                },
                {
                    id: 3,
                    name: "Community",
                    description: "Questions about your support systems and social connections.",
                    questions: [
                        "Our families support our relationship",
                        "Our kids support our relationship",
                        "Our friends support our relationship",
                        "We are well-matched in our preferences for socializing with friends and family",
                        "We both have individual support systems",
                        "We seek support when we need it"
                    ]
                },
                {
                    id: 4,
                    name: "Emotional Needs",
                    description: "Questions about emotional connection and support.",
                    questions: [
                        "I feel loved in this relationship",
                        "I feel good about myself in this relationship",
                        "This relationship brings out the best in me",
                        "I feel respected in this relationship",
                        "I feel appreciated in this relationship",
                        "I get my needs met in this relationship",
                        "My partner is generous with me",
                        "My partner is supportive of me",
                        "I have all the affection I want",
                        "I get all the attention I need"
                    ]
                },
                {
                    id: 5,
                    name: "Communication",
                    description: "Questions about how you communicate and resolve conflicts.",
                    questions: [
                        "We communicate easily and well",
                        "I feel heard in this relationship",
                        "My partner listens and really 'gets' what I'm saying",
                        "We resolve conflict well",
                        "We are open and honest with each other",
                        "We don't hold grudges",
                        "We are both comfortable and able to ask for what we want"
                    ]
                },
                {
                    id: 6,
                    name: "Fun & Recreation",
                    description: "Questions about joy, play, and shared enjoyment.",
                    questions: [
                        "We have fun together",
                        "We laugh and play together",
                        "We enjoy the same types of humor",
                        "My partner makes me laugh",
                        "I make my partner laugh",
                        "We enjoy many of the same activities",
                        "We can relax together"
                    ]
                },
                {
                    id: 7,
                    name: "Home Management",
                    description: "Questions about household responsibilities and living environment.",
                    questions: [
                        "We are in alignment about how to handle kids",
                        "We are in alignment about who does what around the house",
                        "We are in alignment about our level of organization/neatness around the house",
                        "We share equally in caring for our home",
                        "Our home environment feels comfortable to both of us",
                        "We make decisions together about our home",
                        "We respect each other's space and belongings"
                    ]
                },
                {
                    id: 8,
                    name: "Sexuality",
                    description: "Questions about physical intimacy and attraction.",
                    questions: [
                        "I experience strong chemistry",
                        "I experience passion in this relationship",
                        "I experience romance in this relationship",
                        "I find my partner very attractive",
                        "I get turned on with my partner",
                        "I know what turns on my partner",
                        "We talk about our sexual preferences and needs",
                        "I'm fulfilled sexually in this relationship"
                    ]
                },
                {
                    id: 9,
                    name: "Personality & Development",
                    description: "Questions about intellectual and emotional compatibility.",
                    questions: [
                        "We are well-matched intellectually",
                        "We are well-matched emotionally",
                        "We are well-matched developmentally (maturity, etc)",
                        "We know and accept each other's quirks",
                        "We intimately know each other's likes and dislikes, hopes and dreams",
                        "We stimulate positive growth and learning for each other"
                    ]
                }
            ],
            options: [
                { value: 0, label: "Not at all" },
                { value: 1, label: "Somewhat" },
                { value: 2, label: "Mostly" },
                { value: 3, label: "Completely" }
            ]
        };

        // Application State
        let currentSection = 0;
        let responses = {};
        let userData = {};

        // Set today's date as default
        document.getElementById('assessmentDate').valueAsDate = new Date();

        function startAssessment() {
            const userName = document.getElementById('userName').value.trim();
            const partnerName = document.getElementById('partnerName').value.trim();
            const assessmentDate = document.getElementById('assessmentDate').value;

            if (!userName || !partnerName || !assessmentDate) {
                alert('Please fill in all fields before starting.');
                return;
            }

            userData = { userName, partnerName, assessmentDate };
            
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('assessmentForm').classList.add('active');
            
            renderSection(currentSection);
        }

        function renderSection(sectionIndex) {
            const section = assessmentData.sections[sectionIndex];
            const container = document.getElementById('questionsContainer');
            
            // Update section header
            document.getElementById('sectionTitle').textContent = section.name;
            document.getElementById('sectionDescription').textContent = section.description;
            document.getElementById('progressText').textContent = 
                `Section ${sectionIndex + 1} of ${assessmentData.sections.length} - ${section.name}`;
            
            // Update progress bar
            const progress = ((sectionIndex + 1) / assessmentData.sections.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // Clear and render questions
            container.innerHTML = '';
            
            section.questions.forEach((question, qIndex) => {
                const questionId = `s${section.id}_q${qIndex + 1}`;
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                
                questionCard.innerHTML = `
                    <div class="question-number">Question ${qIndex + 1} of ${section.questions.length}</div>
                    <div class="question-text">${question}</div>
                    <div class="options">
                        ${assessmentData.options.map(option => `
                            <label class="option-label">
                                <input type="radio" 
                                       name="${questionId}" 
                                       value="${option.value}"
                                       ${responses[questionId] == option.value ? 'checked' : ''}
                                       onchange="saveResponse('${questionId}', ${option.value})">
                                <span class="checkmark"></span>
                                <span class="option-text">${option.label}</span>
                            </label>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(questionCard);
            });
            
            // Update button states
            document.getElementById('prevBtn').disabled = sectionIndex === 0;
            document.getElementById('nextBtn').textContent = 
                sectionIndex === assessmentData.sections.length - 1 ? 'Complete Assessment' : 'Next Section';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function saveResponse(questionId, value) {
            responses[questionId] = value;
            saveToLocalStorage();
            showAutoSave();
        }

        function showAutoSave() {
            const autoSave = document.getElementById('autoSave');
            autoSave.classList.add('show');
            setTimeout(() => {
                autoSave.classList.remove('show');
            }, 2000);
        }

        function saveToLocalStorage() {
            const data = {
                userData,
                responses,
                currentSection,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('relationshipAssessment', JSON.stringify(data));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('relationshipAssessment');
            if (saved) {
                const data = JSON.parse(saved);
                userData = data.userData;
                responses = data.responses;
                currentSection = data.currentSection;
                
                // Optionally prompt to resume
                if (Object.keys(responses).length > 0) {
                    if (confirm('Would you like to resume your previous assessment?')) {
                        document.getElementById('userName').value = userData.userName;
                        document.getElementById('partnerName').value = userData.partnerName;
                        document.getElementById('assessmentDate').value = userData.assessmentDate;
                        startAssessment();
                    }
                }
            }
        }

        function previousSection() {
            if (currentSection > 0) {
                currentSection--;
                renderSection(currentSection);
                saveToLocalStorage();
            }
        }

        function nextSection() {
            // Check if all questions in current section are answered
            const section = assessmentData.sections[currentSection];
            const unanswered = [];
            
            section.questions.forEach((q, i) => {
                const questionId = `s${section.id}_q${i + 1}`;
                if (responses[questionId] === undefined) {
                    unanswered.push(i + 1);
                }
            });
            
            if (unanswered.length > 0) {
                alert(`Please answer all questions before continuing. Unanswered: ${unanswered.join(', ')}`);
                return;
            }
            
            if (currentSection < assessmentData.sections.length - 1) {
                currentSection++;
                renderSection(currentSection);
                saveToLocalStorage();
            } else {
                completeAssessment();
            }
        }

        function completeAssessment() {
            // Calculate scores
            const scores = {};
            let totalScore = 0;
            let totalQuestions = 0;
            
            assessmentData.sections.forEach(section => {
                let sectionScore = 0;
                section.questions.forEach((q, i) => {
                    const questionId = `s${section.id}_q${i + 1}`;
                    sectionScore += responses[questionId] || 0;
                });
                
                const maxScore = section.questions.length * 3;
                const percentage = Math.round((sectionScore / maxScore) * 100);
                scores[section.name] = { score: sectionScore, max: maxScore, percentage };
                
                totalScore += sectionScore;
                totalQuestions += section.questions.length;
            });
            
            const overallPercentage = Math.round((totalScore / (totalQuestions * 3)) * 100);
            
            // Save final data
            const finalData = {
                userData,
                responses,
                scores,
                overallPercentage,
                completedAt: new Date().toISOString()
            };
            
            localStorage.setItem('relationshipAssessmentComplete', JSON.stringify(finalData));
            
            // Show completion screen
            const container = document.getElementById('questionsContainer');
            container.innerHTML = `
                <div class="completion-screen">
                    <div class="completion-icon">✓</div>
                    <h2>Assessment Complete!</h2>
                    <p>Thank you for completing the Relationship Assessment, ${userData.userName}.</p>
                    <p style="margin-top: 30px; padding: 25px; background: var(--background); border-radius: 16px; font-size: 1.3rem;">
                        <strong>Your Overall Score:</strong><br>
                        <span style="font-size: 2.5rem; color: var(--primary); font-family: 'Playfair Display', serif; font-weight: 700;">${overallPercentage}/100</span>
                    </p>
                    <p style="margin-top: 30px; color: var(--text-secondary);">
                        Your coach has been notified and will review your results.<br>
                        You'll receive a detailed report and next steps soon.
                    </p>
                    <button class="btn btn-primary" onclick="downloadResults()" style="margin-top: 30px;">
                        Download Your Results
                        <span>↓</span>
                    </button>
                </div>
            `;
            
            document.querySelector('.navigation').style.display = 'none';
            document.querySelector('.section-header').style.display = 'none';
            document.querySelector('.progress-container').style.display = 'none';
            document.querySelector('.progress-text').style.display = 'none';
        }

        function downloadResults() {
            const data = JSON.parse(localStorage.getItem('relationshipAssessmentComplete'));
            
            let content = `RELATIONSHIP ASSESSMENT RESULTS\n`;
            content += `================================\n\n`;
            content += `Participant: ${data.userData.userName}\n`;
            content += `Partner: ${data.userData.partnerName}\n`;
            content += `Date: ${data.userData.assessmentDate}\n`;
            content += `Completed: ${new Date(data.completedAt).toLocaleString()}\n\n`;
            content += `OVERALL SCORE: ${data.overallPercentage}/100\n\n`;
            content += `SECTION SCORES:\n`;
            content += `===============\n`;
            
            for (const [name, score] of Object.entries(data.scores)) {
                content += `${name}: ${score.percentage}% (${score.score}/${score.max})\n`;
            }
            
            content += `\n\nDETAILED RESPONSES:\n`;
            content += `===================\n\n`;
            
            assessmentData.sections.forEach(section => {
                content += `\n${section.name.toUpperCase()}\n`;
                content += `-`.repeat(section.name.length) + `\n`;
                
                section.questions.forEach((question, i) => {
                    const questionId = `s${section.id}_q${i + 1}`;
                    const value = data.responses[questionId];
                    const label = assessmentData.options.find(o => o.value == value)?.label || 'Not answered';
                    content += `Q${i + 1}. ${question}\n`;
                    content += `    Answer: ${label}\n\n`;
                });
            });
            
            // Create download
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Relationship_Assessment_${data.userData.userName}_${data.userData.assessmentDate}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Load saved data on page load
        window.addEventListener('load', loadFromLocalStorage);
    </script>
</body>
</html>
